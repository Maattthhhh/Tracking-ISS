<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <link rel="icon" type="image/jpg" sizes="16x16" href="images/internationalspacestation.jpg">
    <title>Where is the ISS?</title>
</head>
<body style="background-color:skyblue;">
<style>
    #bach:hover{
        animation-name: bosch;
        animation-duration: 3s;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
        filter: brightness(100%);
    }
    @keyframes bosch{
        0%{
            transform: rotate(0deg);
        }
        100%{
            transform: rotate(360deg);
        }
    }
    #bach{
        display: block;
        margin-left: auto;
        margin-right: auto;
        box-shadow: #fff 4px 4px 0 0,#000 4px 4px 0 1px;
    }
    h1 {text-align: center;}
    p {text-align: center;}
</style>
    <a href="https://maattthhhh.github.io/Pokemon/Pokemon.html"><img src="internationalspacestation.jpg" style="width:200px; height: 200px" id="bach"></a>
    <h1>Where is the ISS?</h1>
    <p>
        Latitude: <span id="lat"></span><br />
        Longitude: <span id="lon"></span><br />
        Location: <span id="loc"></span><br />
        <span id="cli"></span>
    </p>
    <script>
        const api_url = 'https://api.wheretheiss.at/v1/satellites/25544';
        async function getISS() {
            const response = await fetch(api_url);
            const data = await response.json();
            const { latitude, longitude } = data;
            console.log(latitude);
            console.log(longitude);

            document.getElementById('lat').textContent = latitude;
            document.getElementById('lon').textContent = longitude;

            const geoapiurl = `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=en`;
            const geoResponse = await fetch(geoapiurl);
            const geoData = await geoResponse.json();
            if (geoData.locality && geoData.locality.includes("GMT")) {
				if (geoData.continent){
					document.getElementById('loc').textContent = "The International Space Station is currently near " + geoData.continent + ".";
					document.getElementById('cli').textContent = "Location temperature unavailable";}
				else {
					document.getElementById('loc').textContent = "The International Space Station is currently near the " + geoData.localityInfo.informative[0].name + ".";
				}
			} else if (!geoData.locality) {
				document.getElementById('loc').textContent = "The International Space Station is currently near " + geoData.countryName + ".";
				document.getElementById('cli').textContent = "Location temperature unavailable";
			}else {
				document.getElementById('loc').textContent = "The International Space Station is currently near " + geoData.locality + ", " + geoData.countryName;
				const city = geoData.locality;
				const condition = await getCondition(city);
				document.getElementById('cli').textContent = `The current temperature in ${city} is ${condition}.`;
			}
		async function getCondition(city) {
			const url = `https://wttr.in/${city}?format=%t`;
			const response = await fetch(url);
		    const raw = await response.text();
			const condition = raw.trim();
			return condition;
		}}
		getISS();
	</script>        
</body>
</html>
